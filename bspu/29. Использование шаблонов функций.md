https://phys.bspu.by/static/um/inf/prg/sem3/book/book_c/

# Использование шаблонов функций

- [Использование шаблонов функций](#использование-шаблонов-функций)
  - [СОЗДАНИЕ ПРОСТОГО ШАБЛОНА ФУНКЦИИ](#создание-простого-шаблона-функции)
  - [ШАБЛОНЫ, КОТОРЫЕ ИСПОЛЬЗУЮТ НЕСКОЛЬКО ТИПОВ](#шаблоны-которые-используют-несколько-типов)
  - [ЧТО ВАМ НЕОБХОДИМО ЗНАТЬ](#что-вам-необходимо-знать)

При создании функций иногда возникают ситуации, когда две функции выполняют одинаковую обработку, но работают с разными типами данных (например, одна использует параметры типа int, а другая типа float). Вы уже знаете из урока 13, что с помощью механизма перегрузки функций можно использовать одно и то же имя для функций, выполняющих разные действия и имеющих разные типы параметров. Однако, если функции возвращают значения разных типов, вам следует использовать для них уникальные имена (см. примечание к уроку 13). Предположим, например, что у вас есть функция с именем тах, которая возвращает максимальное из двух целых значений. Если позже вам потребуется подобная функция, которая возвращает максимальное из двух значений с плавающей точкой, вам следует определить другую функцию, например fmax. Из этого урока вы узнаете, как использовать шаблоны C++ для быстрого создания функций, возвращающих значения разных типов. К концу данного урока вы освоите следующие основные концепции:

* Шаблон определяет набор операторов, с помощью которых ваши программы позже могут создать несколько функций. 

* Программы часто используют шаблоны функций для быстрого определения нескольких функций, которые с помощью одинаковых операторов работают с параметрами разных типов или имеют разные типы возвращаемых значений. 

* Шаблоны функций имеют специфичные имена, которые соответствуют имени функции, используемому вами в программе. 

* После того как ваша программа определила шаблон функции, она в дальнейшем может создать конкретную функцию, используя этот шаблон для задания прототипа, который включает имя данного шаблона, возвращаемое функцией значение и типы параметров. 

* В процессе компиляции компилятор C++ будет создавать в вашей программе функции с использованием типов, указанных в прототипах функций, которые ссылаются на имя шаблона. 

Шаблоны функций имеют уникальный синтаксис, который может быть на первый взгляд непонятен. Однако после создания одного или двух шаблонов вы обнаружите, что реально их очень легко использовать.

## СОЗДАНИЕ ПРОСТОГО ШАБЛОНА ФУНКЦИИ

Шаблон функции определяет типонезависимую функцию. С помощью такого шаблона ваши программы в дальнейшем могут определить конкретные функции с требуемыми типами. Например, ниже определен шаблон для функции с именем тах, которая возвращает большее из двух значений:

```c++
template<class Т>
Т mах(Т а, Т b){
  if (а > b) return(а);
  else return(b);
}
```
Буква T данном случае представляет собой общий тип шаблона. После определения шаблона внутри вашей программы вы объявляете прототипы функций для каждого требуемого вам типа. В случае шаблона тах следующие прототипы создают функции типа float и int.

```c++
float max(float, float);
int max(int, int);
```

Когда компилятор C++ встретит эти прототипы, то при построении функции он заменит тип шаблона T указанным вами типом. В случае с типом float функция тах после замены примет следующий вид:

```c++
template<class Т>
Т max(Т а, Т b) {
  if (a > b) return(а);
  else return(b);
}

float max(float a, float b) {
  if (a > b) return(a);
  else return(b); 
}
```

Следующая программа МАХ_ТЕМР.СРР использует шаблон тах для создания функции типа int и float.

```c++
#include <iostream>

template<class T>
Т mах(Т а, Т b) {
  if (a > b) return(a);
  else return(b);
}

float max(float, float);

int max(int, int);

void main() {
  std::cout << 
    "Максимум 100 и 200 равен " << 
    max(100, 200) << 
    std::endl;
  
  std::cout << 
    "Максимум 5.4321 и 1.2345 равен " << 
    max(5.4321, 1.2345) << 
    std::endl;
  
  return 0;
}
```

В процессе компиляции компилятор C++ автоматически создает операторы для построения одной функции, работающей с типом int, и второй функции, работающей с типом float. Поскольку компилятор C++ управляет операторами, соответствующими функциям, которые вы создаете с помощью шаблонов, он позволяет вам использовать одинаковые имена для функций, которые возвращают значения разных типов. Вы не смогли бы это сделать, используя только перегрузку функций, как обсуждалось в уроке 13.

> ### Использование шаблонов функций
> 
> По мере того как ваши программы становятся более сложными, возможны ситуации, когда вам потребуются подобные функции, выполняющие одни и те же операции, но с разными типами данных. Шаблон функции позволяет вашим программам определять общую, или типонезависимую, функцию. Когда программе требуется использовать функцию для определенного типа, например int или float, она указывает прототип функции, который использует имя шаблона функции и типы возвращаемого значения и параметров. В процессе компиляции C++ создаст соответствующую функцию. Создавая шаблоны, вы уменьшаете количество функций, которые должны кодировать самостоятельно, а ваши программы могут использовать одно и то же имя для функций, выполняющих определенную операцию, независимо от возвращаемого функцией значения и типов параметров.


## ШАБЛОНЫ, КОТОРЫЕ ИСПОЛЬЗУЮТ НЕСКОЛЬКО ТИПОВ

Предыдущее определение шаблона для функции max использовало единственный общий тип Т. Очень часто в шаблоне функции требуется указать несколько типов. Например, следующие операторы создают шаблон для функции show_array, которая выводит элементы массива. Шаблон использует тип Т для определения типа массива и тип Т1 для указания типа параметра count:

```c++
template<class T, class S>
void show_array(T *array, S count) {
  S index;
  
  for (index = 0; index < count; index++)
    std::cout << array[index] << ' '; 
  
  std::cout << std::endl;
}
```

Как и ранее, программа должна указать прототипы функций для требуемых типов:

```c++
void show_array(int *, int);
void show_array(float *, unsigned);
```

Следующая программа SHOW_TEM.CPP использует шаблон для создания функций, которые выводят массивы типа int и типа float.

```c++
#include <iostream>

template<class T, class S>
void show_array(T *array, S count) {
  S index;

  for (index = 0; index < count; index++)
    std::cout << array[index] “ ' ';
  
  std::cout << std::endl;
}

void show_array(int *, int);

void show_array(float *, unsigned);

void main() {
  int pages[] = { 100, 200, 300, 400, 500 };

  float pricesH = { 10.05, 20.10, 30.15 };

  show_array(pages, 5);

  show_array(prices, 3);

  return 0;
}
```

> ### Шаблоны и несколько типов
> 
> По мере того как шаблоны функций становятся более сложными, они могут обеспечить поддержку нескольких типов. Например, ваша программа может создать шаблон для функции с именем array_sort, которая сортирует элементы массива. В данном случае функция может использовать два параметра: первый, соответствующий массиву, и второй, соответствующий количеству элементов массива. Если программа предполагает, что массив никогда не будет содержать более 32767 значений она может использовать тип int для параметра размера массива. Однако более универсальный шаблон мог бы предоставить программе возможность указать свой собственный тип этого параметра, как показано ниже:
> 
> ```c++
> template<class Т, class S>
> void array_sort(T array[], S elements) {
>   // операторы 
> }
> ```
> 
> С помощью шаблона array_sort программа может создать функции которые сортируют маленькие массивы типа float (менее 128 элементов) и очень большие массивы типа int, используя следующие прототипы:
> 
> ```c++
> void array_sort(float, char);
> void array_sort(int, long);
> ```

## ЧТО ВАМ НЕОБХОДИМО ЗНАТЬ

Как вы уже знаете, использование шаблонов функций уменьшает объем программирования, позволяя компилятору C++ генерировать операторы для функций, которые отличаются только типами возвращаемых значений и параметров. 

Из урока 30 вы узнаете, как использовать шаблоны для создания типонезависимых, или общих, классов. 

До изучения урока 30 убедитесь, что вы освоили следующие основные концепции:

1. Шаблоны функций позволяют вам объявлять типонезависимые, или общие, функции.

2. Когда вашей программе требуется использовать функцию с определенными типами данных, она должна указать прототип функции, который определяет требуемые типы.

3. Когда компилятор C++ встретит такой прототип функции, он создаст операторы, соответствующие этой функции, подставляя требуемые типы.

4. Ваши программы должны создавать шаблоны для общих функций, которые работают с отличающимися типами. Другими словами, если вы используете с какой-либо функцией только один тип, нет необходимости применять шаблон.

5. Если функция требует несколько типов, шаблон просто назначает каждому типу уникальный идентификатор, например Т, T1 и Т2. Позже в процессе компиляции компилятор C++ корректно назначит типы, указанные вами в прототипе функции.